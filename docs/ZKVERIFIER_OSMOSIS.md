ZKVerifier (Osmosis/Cosmos) â€” Zero-Knowledge Proof Verification Specification

This document defines the ZKVerifierOsmosis, the Cosmos-based verification module responsible for validating Zero-Knowledge proofs generated after locking ADA on Cardano.

This is a critical part of the trustless ZKADA bridge, ensuring that Cosmos can mint cADA only after receiving a verified cryptographic proof of lock state from Cardano.

ðŸ”· 1. Purpose

ZKVerifierOsmosis ensures:

Trustless minting of cADA

No forged proofs generate tokens

Verified Cardano state transitions

1:1 backing between ADA and cADA

Full independence from multisigs or custodians

Replay-protection of events

ðŸ”· 2. High-Level Flow
ADA â†’ Cosmos (for minting)

User locks ADA on Cardano

zkVM analyzes lock state

zkVM generates ZK proof

Proof submitted to Cosmos

ZKVerifierOsmosis validates proof

cADA is minted to user

Cosmos â†’ Cardano (for unlocking)

ZKVerifierOsmosis also:

verifies burn events

prepares state data for zkVM

ensures replay-safe exit back to Cardano

ðŸ”· 3. Input Format for Verification

ZKVerifierOsmosis receives a payload:

Field	Type	Description
zk_proof	bytes	Raw ZK proof generated by zkVM
proof_commitment	bytes32	Hash commitment
expected_lock_state	bytes32	Hash of lock UTXO on Cardano
lock_tx_hash	bytes32	Hash of ADA lock transaction
mint_recipient	string	Cosmos address of recipient
amount	u128	Amount of cADA to mint

This ensures full state transparency and deterministic validation.

ðŸ”· 4. Verification Steps
4.1 Proof Integrity

hash(zk_proof) == proof_commitment

Ensures proof has not been altered

4.2 ZK Proof Verification

Using Cosmos-side verifier:

Validates inclusion of Cardano lock event

Ensures lock state was correctly interpreted

Confirms no forged inputs

Confirms correct circuit execution

4.3 State Matching

expected_lock_state must match hash from ZK output

Prevents counterfeit minting

4.4 Replay Protection

lock_tx_hash is recorded after first use

Cannot be reused to mint again

Guarantees 1:1 minting with ADA locks

4.5 Mint Authorization

If all checks pass â†’
ZKVerifierOsmosis triggers cADA mint with verified amount.

ðŸ”· 5. Burn Verification (Cosmos â†’ Cardano)

For the return path:

User burns cADA

Burn event stored

Burn state hashed

zkVM reads Cosmos state

zkVM produces proof

Proof submitted on Cardano

ADA is unlocked only if all checks pass

ZKVerifierOsmosis ensures burn events are authenticated and replay-safe.

ðŸ”· 6. Storage Layout (CosmWasm)

Recommended fields:

Key	Description
used_lock_tx_hashes	Prevents replay minting
used_burn_tx_hashes	Prevents replay unlocking
expected_proof_roots	ZK proof state commitments
cADA_contract_addr	cw20 token address
circuit_id	ID of circuit used by zkVM
ðŸ”· 7. Contract Entry Points

verify_and_mint â€” validates proof + mints cADA

verify_burn â€” validates burn proof

query_lock_state â€” debugging / optional

admin_set_contracts â€” only for deploy-time initialization

proof_commit_match â€” internal integrity checker

No entry point relies on human signatures.

ðŸ”· 8. Security Requirements

ZKVerifierOsmosis must guarantee:

No minting without valid proof

No unlocking without burn proof

No manipulation of proof bytes

No forged state accepted

Prevention of replay attacks (strict hash tracking)

Minimal trust footprint

Fully deterministic verification

ðŸ”· 9. Phase 1 Deliverables

This file contributes directly to:

Milestone 3 â€” Cosmos contract specification

Milestone 4 â€” zkVM feasibility

Milestone 5 â€” security model

Milestone 6 â€” full bridge roadmap

Implementation will start in Phase 2, once research is completed.
